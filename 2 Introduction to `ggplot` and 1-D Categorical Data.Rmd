---
title: "36-315 Homework 02, Spring 2019"
author: "Jingyuan Xing"
date: "Due Wednesday, Sept 11, 2019 (11:59pm ET) on Canvas"
output: 
  html_document:
    toc:  true
    toc_float:  true
    code_folding:  show
---

#  Homework 02:  Introduction to `ggplot` and 1-D Categorical Data


***
***


#  Problem 1

**`R` Style Guides:  Google vs. Hadley**:  

One important step in facilitating reproducible data analysis is writing easily readable, well-documented code.  To ensure that you do this, you are required (for the rest of the semester) to adhere to one of the following two `R` Style Guides:

Google's `R` Style Guide:  [https://google.github.io/styleguide/Rguide.xml]

Hadley Wickham's Advanced `R` Style Guide:  [http://adv-r.had.co.nz/Style.html]

a.  (9 points)  What are the main differences between these two style guides?  Find at least 5 differences.

+ Google's style guide prefer to name variables with BigCamelCase, which capitalize first letter of each word, and stick them together; Wickham's style guide prefer to name variables using underscores, which links words in the variable name using underscores, and everything is lowercased.
+ Google's style guide requires explicit returns. It told us not to rely on R's implicit return feature. Google thinks it is better to be clear about your intent to return( ) an object. Wickham's style guide didn't stress about using explicit returns.
+ For variable assignment, Google's style guide stressd on always use left-hand assignment rather than right-hand assignment. To be specific, we should always do "var <- " instead of "-> var", according to Google. Wickham's style guide stressd on using "<-" rather than "=" for variable assignment.
+ According to Google's style guide, we shouldn't use attach( ). The Wickham's style guide didn't require this.
+ Wickham's style guide said that an opening curly brace should never go on its own line and should always be followed by a new line. A closing curly brace should always go on its own line, unless itâ€™s followed by "else". Google's style guide didn't specify this.

b.  (1 point)  Specify which style guide you will be using in this assignment.

I would like to use the Google style guide.


***
***


#  Problem 2

**Critiquing Graphs**:

Find a graph from the internet (last 7 days -- e.g. a news article, blog post, etc) or from an academic journal (last 60 days).  Describe and critique your graph using the suggestions below.  In parts (b)-(d), you do not have to address each bullet below -- these are just suggestions of things you can discuss when describing/critiquing your graph.

a.  (5 points)  **Include the graph in your assignment**.

<div style="width:400px">
![](https://wifinowevents.s3.amazonaws.com/uploads/2019/09/uk-hungry-apps.jpg)
</div>

b.  (5 points)  **Describe the graph**.  

+  What does the graph show? The graph shows the top 10 apps that are guilty of using up the most data in UK.
+  What variables are plotted on the axes, via color, or via other features of the graph? It's a typical bar chart, facing horizontal direction. The x-axis shows data usage percentage for each of the apps we are interested in; and the y-axis lists these 10 apps, ordered from the most data usage to the least data usage. Each graph is filled with a distinct color. Some other nice feature of this graph include attaching corresponding logos for each app. Logo makes it easier for readers to identify each app.
+  What is the main result of the graph? The main result of the graph is to identify the top 10 most data consuming apps among UK users.

c.  (5 points)  **Critique the graph**.

+  Does the graph do a good job of achieving its goals? Yes, this graph did a good job of achieving its goals.
+  Does the graph use an unnecessary amount of data ink? I would say bar graph is a pretty good representation of what the graph wants to show, and it didn't use much extra ink. However, color each bar with a distinct color may be unnecessary.
+  Does the graph distort the actual effect/data/relationship? No, the graph didn't distort the actual data.
+  What are the strengths and weaknesses (if any) of the graphic? The first strength of this graph is that it represents percentage of data usage very clearly. It's really easy for me as a reader to tell which app consumes the most data just by looking at each bar length. It's also really nice that the graph listed these data consuming apps in decending order. The third strength is that this graph added logo next to each corresponding apps. Yet, there are still some weaknesses. First, the graph is facing horizontally. Normally bar graphs would face vertically, which makes it easier to interpret the results. Also the graph didn't label it's x-axis, so it's a bit unclear "what percentage" is it refering to.
+  What would you change (if anything) about this graphic? I would make the bar chart face vertically, which is more intuitive to read. I would also label the x-axis.

d.  (5 points)  **Critique the caption and/or surrounding text**.  

+  Does the text enhance the user's understanding of the graphic? Yes. Both the title and the app names are helpful for me to understand the graphic.
+  What else would you include in the caption/surrounding text to help the viewer understand the graphic? I would add labels for x and y axis.



***
***


#  Problem 3

**Bar Charts**:  

a.  (1 point)  Load the Titanic data from Lab 02.  How many rows does the dataset have?  How many columns does the dataset have? Is Pclass an ordered variable?

```{r, warning = FALSE, message = FALSE}
#  Load the tidyverse package into R
library(tidyverse)

#  Load the data into R
titanic <- read_csv("https://raw.githubusercontent.com/mateyneykov/315_code_data/master/data/titanic.csv")

# make Pclass is recognized as factor variable
titanic <- mutate(titanic, Pclass = factor(Pclass))

print(titanic)
```

There are 712 rows and 12 columns in this dataset. Pclass is an ordered variable.

b.  (5 points)  Create a bar chart of the `Pclass` variable.  Change the `fill` and `color` commands.  What do each of them do?

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class",
       x = "Passenger Class", 
       y = "Number of Individuals")
```

"fill" is the filled color of the bar, "color" is the margin color of the bars.

c.  (4 points)  You can also specify HEX color values when choosing a color

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "#99ffdd", color = "#ffe6ff") +
  labs(title = "Number of Individuals in Each Passenger Class",
       x = "Passenger Class", 
       y = "Number of Individuals")
```


***
***


#  Problem 4

**Spine Charts**:  

a.  (4 points)  Re-create the graph from Problem 3, but use a spine chart. That is, use a spine chart to show the distribution of `Pclass`. Be sure to correctly label the axes -- remember, their interpretation may have changed from Problem 3.  Include an appropriate title (always do this).

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(x = factor(1), fill = Pclass)) +
  labs(title = "Number of Individuals in Passenger Classes",
       x = "Passenger Class", 
       y = "Number of Individuals",
       fill = "Passenger Class")
```

b.  (3 points)  In a spine chart, what are the widths of the bars proportional to (if anything)?  What are the heights of the bars proportional to (if anything)?  How is this different from a bar chart?

The width contains no information, it's the same for all three classes. The heights of the bar is porportional to 100% of the passenger population, and each color in this bar is porportional to percentage of 1st, 2nd, and 3rd class passengers. This is different from a bar chart in the way that three classes are stacked together, so we are easier to identify the porportion of each class passenger relative to the entire passengers population from the spine chart. In Bar chart, it is hard to tell the relationship between each class and the whole.

c.  (3 points)  `ggplot()` allows us to easily flip the orientation of our graphs without changing any of the code.  

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(x = factor(1), fill = Pclass)) +
  labs(title = "Number of Individuals in Each Passenger Class",
       x = "Passenger Class", 
       y = "Number of Individuals",
       fill = "Passenger Class") +
  coord_flip()
```

After flipping the graph from facing vertically to facing horizontally, we now have the number of individuals count on the x-axis. Now the height doesn't contain information, and the width is porportional to the percentage of passengers in each class relative to the whole.

d.  (BONUS:  1 point)  Remove the ugly `factor(1)` from the x-axis label, without changing the rest of the graphic.

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(x = factor(1), fill = Pclass)) +
  labs(title = "Number of Individuals in Each Passenger Class",
       x = "Passenger Class", 
       y = "Number of Individuals",
       fill = "Passenger Class") +
  theme(axis.text.x = element_blank())
```

e. (BONUS: 1 point) Remove the tick on the x-axis.

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(x = factor(1), fill = Pclass)) +
  labs(title = "Number of Individuals in Each Passenger Class",
       x = "Passenger Class", 
       y = "Number of Individuals",
       fill = "Passenger Class") +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank())
```

***
***


#  Problem 5

**Rose Diagrams**:  

a.  (4 points)  Re-create the graph from Problem 3, but use a rose diagram.  Be sure to correctly label the axes, if necessary.  Include an appropriate title.

```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(fill = Pclass)) +
  coord_polar() +
  labs(title = "Rose Diagram of people in each Passenger Class",
       x = "Passenger Class", 
       y = "Porportion of Number of Individuals")
```

b.  (3 points)  In a rose diagram, what is the radius of each rose petal proportional to?  What does the angle associated with each rose petal correspond to (if anything)?  What is the area of each rose petal proportaional to?

The radius is porportional to the count of individuals. Since all the angles are the same, it's not associated to anything. The area of each petal is porportional to square radius.

***
***


#  Problem 6

**Pie Charts**:  

To create a pie chart, use a similar technique to what you used to create a spine chart in Problem 4 (hint: check the argument `theta` of the function `coord_polar`). 

a.  (4 points)  Re-create the graph from Problem 3, but use a pie chart.  Be sure to correctly label the axes, if necessary.  Include an appropriate title.

```{r, warning = FALSE, message = FALSE}
library(ggplot2)
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(aes(x = factor(1), fill = Pclass)) + 
  coord_polar(theta = 'y') +
  labs(title = "Percentage of Individuals in Each Passenger Class",
       x = '',
       y = '',
       fill = "Passenger Class")
```

b.  (3 points)  In a pie chart, what does the radius of each pie slice correspond to (if anything)?  What does the angle associated with each pie slice correspond to (if anything)?

Radius correspond to nothing. Angles are porportional to percentage of each class relative to the entire passenger population.

c.  (3 points)  Summarize the differences between a rose diagram and a pie chart in no more than two sentences.

First, in rose diagram radius has meaning and angle is meaningless, while in pie chart radius is menaingless and angles has meaning. Secondly, the rose diagram stress on counts, while pie chart focus on percentage of each category relative to the whole.

d.  (10 points)  Of the four graphs we used to visualize the `Pclass` variable, which do you prefer?  Why?  Discuss the strengths (if any) and weaknesses (if any) of each.

I would prefer pie chart. Because it not only shows us which class is the most common, which class is the least common; it also shows us the relative percentage of each class comparing to the whole.  
  
Bar chart: the strength is that it separate three classes, which makes it easy to distinguish. The weakness is that it doesn't show the relationship between each class comparing to the whole.  
  
Spine chart: the strength is that it stacks all three classes together, so we can see how each class compare to the whole passenger population. The weakness is that we can't view the comparison between classes clearly. If the counts for two classes are really close, it would be really hard to tell the height difference from the spine chart.    
  
Rose diagram: the strength is that, since the area of the petal is porportional to squared radius, which means the area is porportional to squared count, it can magnify how we see the counts. The count difference between each class becomes extra obvious when using rose diagram. However, the weakness is that rose diagram is not as intuitive to interpret as the other three graphs.  
  
Pie chart: the strength is that it shows the percentage of each class comparing to the entire passenger population. The weakness is that it doesn't show the count, or in another word, the frequency of each class very clearly.  

***
***


#  Problem 7

**Statistical Tests**:

Your friend says to you, "The passengers were equally likely to belong to any of the three classes."  

You obviously disagree.  You show your friend your graphs from the previous four problems, but your friend is still unconvinced, and wants to know if the differences across the classes in your graph are statistically significant.  

(5 points)  What kind of statistical test could you use to show that the passengers are not equally likely to belong to any of the three classes? (think back to your earlier statistics classes)

Chi-square test of goodness of fit.

(BONUS: 2 points) What statistical test would you use to answer the question whether a passenger's class was associated with a passenger's survival rate?

Chi-square Test for Independence.

***
***


#  Problem 8

(3 points each)

**Facetting**:

a.  Recreate the plot from Problem 3, but this time, facet on the `Embarked` variable.  To do this, add `+ facet_wrap(~ facetting_variable)` to the existing line of code.

```{r, warning = FALSE, message = FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Embarked Port",
       x = "Passenger Class", 
       y = "Number of Individuals") +
  facet_wrap(~ Embarked)
```

b.  Adjust the `ncol` or `nrow` arguments in `facet_wrap()`.  How do they affect the way `facet_wrap()` places each facet into a grid of graphs?

```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Embarked Port",
       x = "Passenger Class", 
       y = "Number of Individuals count") +
  facet_wrap(~ Embarked, nrow = 3, ncol = 1)
```

nrow and ncol determines the layout of chart blocks. For example, if we set ncol to 1, then the three chart blocks will be stacked into one column.

c.  Recreate the plot from Problem 3, but this time, facet on the `Parch` variable using the `facet_grid()` function.

```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Parent/Children",
       x = "Passenger Class", 
       y = "Number of Individuals") +
  facet_grid(~ Parch)
```

d.  Recreate the graph from part (c), but this time, add `+ facet_grid(facetting_variable ~ .)` instead.  What changed?  Which version do you prefer for this particular problem?  Why?

```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Parent/Children",
       x = "Passenger Class", 
       y = "Number of Individuals") +
  facet_grid(Parch ~ .)
```

The graphs changed from next to each other (in one row), to on top of each other (in one column). I would prefer the previous layout for this problem, because it allows me to compare the heights more clearly.

e.  We can actually facet on multiple categorical variables at once.  Let's try it.  Recreate the graph from part (d), but this time, facet on both the `Sex` and `Survived` variables. Interpret the graph. 

```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Sex and Survival",
       x = "Passenger Class", 
       y = "Number of Individuals") + 
  facet_grid(Sex ~ Survived)
```

The graph shows us the count of individuals partitioned according to their gender and whether they survived. From the graph we can see that for those who died, vast majority of them are male. Also, for those who died, most of them are from the third class. Which means first and second class passengers are given priority to survive than the third class passengers.  
If we look at the graph by gender, we can see that for females, those who survived is more than those who died; and for males, those who died is much more than those who survived. This implies that most males gave survival opportunities to females at the time when the ship sank.

f. Repeat the facetting but this time use `Sex` and `Parch`. Some of the facets in the graph are empty. Why? (Hint:  Look at a contingency table of these two variables with `table(titanic$Parch, titanic$Sex)`.) Briefly interpret graph.


```{r message=FALSE, warning=FALSE}
ggplot(data = titanic, aes(x = Pclass)) + 
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Number of Individuals in Each Passenger Class Facet by Sex and Parent/Children",
       x = "Passenger Class", 
       y = "Number of Individuals") + 
  facet_grid(Sex ~ Parch)

table(titanic$Parch, titanic$Sex)
```

Some of the facets in the graph are empty because there is no male passengers that has six parent/children on board. As shown in the table result, people typically don't take that many relatives (3 or more) that travel with them.

***
***



